# 关于bios
## bios是什么
bios是base input output system,是固定在主板上的一块rom芯片，整个存储空间为1MB，

---
## bios的功能
**一、初始化硬件** 通过调用硬件提供的接口对硬件进行初始化和检测（Power-On Self Test），并引导操作系统启动  
**二、建立中断向量表** 可以通过int 0x的方式直接调用对应的硬件     
**三、硬件配置**用户可以通过bios设置系统时钟等

---

# 实模式
在计算机加电之后，此时还没有操作系统来协助我们管理计算机的各种资源，这时的计算机是工作在实模式下的，用户可以直接
使用物理地址访问存储介质，bios代码块存储在**0xF0000-0xFFFFF**，0xffff0-0xfffff这16B存储的是一条jump指令，即jump far f000:e05b，
计算机在加电后，cs会自动初始化为0xf000，ip为0xfff0，cpu开始执行0xffff0处的跳转指令，**0xfe05b**是bios指令序列开始的地址。

---

# MBR
MBR代码的地址是**0x7c00-0x7dff**，一共是512B            
在bios的最后一步是检查0盘0道1扇区的最后两个字节，若第511个字节为0xaa，第512个字节为0x55，那么该扇区就是活动扇区，bios就会将该扇区加载到内存中，并立刻跳转到0x7c00处执行该地址后的指令(通过jump 0:0x7c00实现)，0x7c00就是MBR的起始地址，这里的代码可以由我们编写

---

# 自己编写MBR

1.使用**nano**创建一个mbr.s文件，并对文件进行编辑 

---
2.使用**nasm**对mbr文件进行编译，生成mbr.bin,具体的命令时nasm -o [of] [if]，-o制定了输出的文件名称，默认时输出a.out.NASM（Netwide Assembler）是一种用于 x86 和 x86-64 架构的汇编器，它主要用于编写汇编语言代码并将其转换为可执行的机器码程序。  

---

3.使用**dd**将mbr的机器码刻录到0盘0道1扇区，dd 命令是 Linux 和 Unix 系统中用于低级数据复制和转换的强大工具。它可以用于从一个设备到另一个设备的复制，也可以将数据转换为特定格式。具体的命令时**dd= [if] [of] bs=512 count=1 conv=notrunc**，*bs*指定了块的大小，count指定了块的数量
*skip=N*指定了跳过输入文件前N个块开始复制，*seek=N*指定跳过输出文件的前N个块开始写入，*conv*表示在文件复制过程中的转换操作，notrunc表示在文件复制过程中不截断输出文件，保留输出文件原始大小，默认情况下dd操作会把输出文件截断为固定大小。  

---


# 测试
1.进入bochs安装目录，运行**./bochs -f [configfile]**,进入模拟器  
2.输入6启动模拟器，并键入c继续，可以看到屏幕上打印出几个字符



